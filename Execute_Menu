-- –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (LocalScript) –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ StarterPlayerScripts
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local localPlayer = Players.LocalPlayer
local playerGui = localPlayer:WaitForChild("PlayerGui")

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ScriptExecutorUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 500, 0, 400)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
mainFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
titleBar.Parent = mainFrame

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(0.7, 0, 1, 0)
titleLabel.Position = UDim2.new(0, 10, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Script Executor"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -30, 0, 0)
closeButton.Text = "X"
closeButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Parent = titleBar

local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -60, 0, 0)
minimizeButton.Text = "_"
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 60)
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.Parent = titleBar

-- –û–±–ª–∞—Å—Ç—å –¥–ª—è –≤–≤–æ–¥–∞ —Å–∫—Ä–∏–ø—Ç–∞
local scroller = Instance.new("ScrollingFrame")
scroller.Size = UDim2.new(1, -20, 0.8, -10)
scroller.Position = UDim2.new(0, 10, 0, 40)
scroller.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
scroller.CanvasSize = UDim2.new(0, 0, 5, 0)
scroller.ScrollBarThickness = 12
scroller.Parent = mainFrame

local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(1, -5, 1, -5)
textBox.Position = UDim2.new(0, 5, 0, 5)
textBox.BackgroundTransparency = 1
textBox.Text = "print('Hello, Roblox!')\nwait(1)\nprint('Script finished!')"
textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
textBox.TextXAlignment = Enum.TextXAlignment.Left
textBox.TextYAlignment = Enum.TextYAlignment.Top
textBox.TextWrapped = false
textBox.MultiLine = true
textBox.TextScaled = false
textBox.ClearTextOnFocus = false
textBox.TextSize = 16
textBox.Font = Enum.Font.Code
textBox.PlaceholderText = "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Lua —Å–∫—Ä–∏–ø—Ç –∑–¥–µ—Å—å..."
textBox.Parent = scroller

-- –û–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ AutoExecute
local autoExecuteButton = Instance.new("TextButton")
autoExecuteButton.Size = UDim2.new(0, 120, 0, 40)
autoExecuteButton.Position = UDim2.new(0.5, -60, 0.85, 0)
autoExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
autoExecuteButton.Text = "AutoExecute"
autoExecuteButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoExecuteButton.TextSize = 18
autoExecuteButton.Parent = mainFrame

-- –õ–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
local isMinimized = false
local originalSize = mainFrame.Size
local originalPosition = mainFrame.Position


-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
local currentThread = nil
local isRunning = false

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
closeButton.MouseButton1Click:Connect(function()
	if currentThread and isRunning then
        task.cancel(currentThread)
        currentThread = nil
        isRunning = false
    end
    screenGui:Destroy()
end)

minimizeButton.MouseButton1Click:Connect(function()
    if isMinimized then
        -- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
        mainFrame.Size = originalSize
        scroller.Visible = true
        autoExecuteButton.Visible = true
        isMinimized = false
    else
        -- –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ
        originalSize = mainFrame.Size
        originalPosition = mainFrame.Position
        mainFrame.Size = UDim2.new(0, 400, 0, 30)
        scroller.Visible = false
        autoExecuteButton.Visible = false
        isMinimized = true
    end
end)

local function executeUserCode(code)
    -- –ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–∂–µ –∏–¥–µ—Ç, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
    if currentThread and isRunning then
        task.cancel(currentThread)
        currentThread = nil
        isRunning = false
        autoExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
        autoExecuteButton.Text = "AutoExecute"
        return
    end
    
    -- –ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–∂–µ –∏–¥–µ—Ç, –Ω–µ –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤–æ–µ
    if isRunning then
        return
    end
    
    -- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è "–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è"
    isRunning = true
    autoExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
    autoExecuteButton.Text = "STOP"
    
    -- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –≤ —Ü–∏–∫–ª—ã while
    local protectedCode = code:gsub("(while%s+[^%s].-)%s+do", "%1 do task.wait(0.00001); ")
    
    -- –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –¥–æ—Å—Ç—É–ø–æ–º –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
    local env = getfenv()
    env.script = nil -- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    
    -- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ—Ä—É—Ç–∏–Ω–µ
    currentThread = task.spawn(function()
        local functionToRun, compileError = loadstring(protectedCode)
        
        if not functionToRun then
            -- –ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
            functionToRun, compileError = loadstring("return " .. protectedCode)
        end
        
        if not functionToRun then
            warn("–û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏: " .. tostring(compileError))
            isRunning = false
            autoExecuteButton.Text = "AutoExecute"
            autoExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
            return
        end
        
        -- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        setfenv(functionToRun, env)
        
        local success, runtimeError = pcall(functionToRun)
        
        if not success then
            warn("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: " .. tostring(runtimeError))
        end
        
        -- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        isRunning = false
        currentThread = nil
        autoExecuteButton.Text = "AutoExecute"
        autoExecuteButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
    end)
end

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ AutoExecute
autoExecuteButton.MouseButton1Click:Connect(function()
    executeUserCode(textBox.Text)
end)

-- –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
textBox:GetPropertyChangedSignal("Text"):Connect(function()
    -- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ CanvasSize –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
    local lineCount = 0
    for _ in textBox.Text:gmatch("\n") do
        lineCount = lineCount + 1
    end
    scroller.CanvasSize = UDim2.new(0, 0, 0, math.max(400, (lineCount + 5) * 20))
end)

print("üöÄ Script Executor –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
print("üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ctrl+Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
print("üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Escape –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
